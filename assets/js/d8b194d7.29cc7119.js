"use strict";(self.webpackChunk_5kdk_blog=self.webpackChunk_5kdk_blog||[]).push([[2916],{1045:e=>{e.exports=JSON.parse('{"permalink":"/blog/2025/04/04/how-to-handle-queryKeys-more-securely","editUrl":"https://github.com/5kdk/5kdk.github.io/tree/main/blog/2025-04-04-how-to-handle-queryKeys-more-securely.md","source":"@site/blog/2025-04-04-how-to-handle-queryKeys-more-securely.md","title":"queryKey\ub97c \ubcf4\ub2e4 \uc548\uc804\ud558\uac8c \uad00\ub9ac\ud558\ub294 \ubc29\ubc95","description":"TanStack React Query\uc758 \ucffc\ub9ac\ud0a4\ub97c \ubcf4\ub2e4 \uc548\uc804\ud558\uac8c \uc0ac\uc6a9\ud558\ub294 \ubc29\ubc95.","date":"2025-04-04T00:00:00.000Z","tags":[{"inline":true,"label":"TanStack React Query","permalink":"/blog/tags/tan-stack-react-query"}],"readingTime":5.84,"hasTruncateMarker":true,"authors":[{"name":"Dongkyu Kim","title":"Front-end Developer","url":"https://github.com/5kdk","imageURL":"https://github.com/5kdk.png","key":"5kdk","page":null}],"frontMatter":{"title":"queryKey\ub97c \ubcf4\ub2e4 \uc548\uc804\ud558\uac8c \uad00\ub9ac\ud558\ub294 \ubc29\ubc95","authors":"5kdk","description":"TanStack React Query\uc758 \ucffc\ub9ac\ud0a4\ub97c \ubcf4\ub2e4 \uc548\uc804\ud558\uac8c \uc0ac\uc6a9\ud558\ub294 \ubc29\ubc95.","tags":["TanStack React Query"],"keywords":["queryKey","QueryKey factories","\ucffc\ub9ac\ud0a4 \uad00\ub9ac","\ucffc\ub9ac\ud0a4 \ud329\ud1a0\ub9ac"],"comments":true},"unlisted":false,"nextItem":{"title":"Yarn v4, Next.js \ud658\uacbd \uc138\ud305\uacfc \ub9c8\uc8fc\ud588\ub358 \uc774\uc288\ub4e4","permalink":"/blog/2024/04/23/yarn-v4-nextjs-issues"}}')},7263:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>d,contentTitle:()=>l,default:()=>a,frontMatter:()=>o,metadata:()=>n,toc:()=>u});var n=t(1045),s=t(3420),i=t(8356);const o={title:"queryKey\ub97c \ubcf4\ub2e4 \uc548\uc804\ud558\uac8c \uad00\ub9ac\ud558\ub294 \ubc29\ubc95",authors:"5kdk",description:"TanStack React Query\uc758 \ucffc\ub9ac\ud0a4\ub97c \ubcf4\ub2e4 \uc548\uc804\ud558\uac8c \uc0ac\uc6a9\ud558\ub294 \ubc29\ubc95.",tags:["TanStack React Query"],keywords:["queryKey","QueryKey factories","\ucffc\ub9ac\ud0a4 \uad00\ub9ac","\ucffc\ub9ac\ud0a4 \ud329\ud1a0\ub9ac"],comments:!0},l=void 0,d={authorsImageUrls:[void 0]},u=[{value:"1. QueryKey factories \uc0ac\uc6a9\ud558\uae30",id:"1-querykey-factories-\uc0ac\uc6a9\ud558\uae30",level:2},{value:"\uc608\uc2dc \ucf54\ub4dc",id:"\uc608\uc2dc-\ucf54\ub4dc",level:3},{value:"2. QueryKey factories\uc758 \ubb38\uc81c\uc810",id:"2-querykey-factories\uc758-\ubb38\uc81c\uc810",level:2},{value:"\uc608\uc2dc \ucf54\ub4dc",id:"\uc608\uc2dc-\ucf54\ub4dc-1",level:3},{value:"3. queryOptions\uc758 \ub4f1\uc7a5",id:"3-queryoptions\uc758-\ub4f1\uc7a5",level:2},{value:"\uc608\uc2dc \ucf54\ub4dc",id:"\uc608\uc2dc-\ucf54\ub4dc-2",level:3},{value:"4. QueryKey factories\ub97c queryOptions\ub85c \uac15\ud654\ud558\uae30",id:"4-querykey-factories\ub97c-queryoptions\ub85c-\uac15\ud654\ud558\uae30",level:2},{value:"\uc608\uc2dc \ucf54\ub4dc",id:"\uc608\uc2dc-\ucf54\ub4dc-3",level:3},{value:"5. \uacb0\ub860",id:"5-\uacb0\ub860",level:2}];function c(e){const r={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(r.p,{children:["\uc774 \uae00\uc5d0\uc11c\ub294 \ucffc\ub9ac \ud0a4(queryKey)\ub97c \ud6a8\uc728\uc801\uc774\uace0 \uc548\uc804\ud558\uac8c \uad00\ub9ac\ud558\uae30 \uc704\ud55c \ud328\ud134\uc778 \ucffc\ub9ac \ud0a4 \ud329\ud1a0\ub9ac(QueryKey factories) \ud328\ud134\uc5d0 \ub300\ud574 \uc124\uba85\ud558\uace0, TanStack React Query v5\uc5d0\uc11c \uc0c8\ub86d\uac8c \ub4f1\uc7a5\ud55c ",(0,s.jsx)(r.code,{children:"queryOptions"})," \ub97c \uacb0\ud569\ud558\uc5ec \ub354\uc6b1 \ud0c0\uc785 \uc548\uc804\ud558\uace0 \uad00\ub9ac\ud558\uae30 \uc26c\uc6b4 \ucffc\ub9ac \ud0a4 \uad00\ub9ac\ubc95\uc744 \ub2e4\ub904\ubd05\ub2c8\ub2e4."]}),"\n",(0,s.jsx)(r.h2,{id:"1-querykey-factories-\uc0ac\uc6a9\ud558\uae30",children:"1. QueryKey factories \uc0ac\uc6a9\ud558\uae30"}),"\n",(0,s.jsxs)(r.p,{children:["React Query\ub97c \uc0ac\uc6a9\ud560 \ub54c \uc5ec\ub7ec \ucffc\ub9ac\ub97c \uad00\ub9ac\ud558\ub2e4 \ubcf4\uba74, \ud0a4 \uad00\ub9ac\uac00 \uc5b4\ub824\uc6cc \ud55c\ucc38 \ucf54\ub4dc\ubca0\uc774\uc2a4\ub97c \ub4e4\uc5ec\ub2e4\ubcf4\uac70\ub098 ",(0,s.jsx)(r.em,{children:"(cursor\ub97c \uad34\ub86d\ud788\uac70\ub098..)"})," \uc911\ubcf5 \ucf54\ub4dc\uac00 \ubc1c\uc0dd\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."]}),"\n",(0,s.jsx)(r.p,{children:"\uc774\ub97c \ubc29\uc9c0\ud558\uae30 \uc704\ud574 \ucd94\ucc9c\ub418\ub294 \ubc29\ubc95\uc774 \ubc14\ub85c \ucffc\ub9ac \ud0a4 \ud329\ud1a0\ub9ac \ud328\ud134\uc785\ub2c8\ub2e4. \uc774 \ud328\ud134\uc740 \ud558\ub098\uc758 \uae30\ub2a5(feature)\uc5d0\uc11c \uc0ac\uc6a9\ud558\ub294 \ucffc\ub9ac \ud0a4\ub97c \uac1d\uccb4 \ud615\ud0dc\ub85c \uad00\ub9ac\ud558\uc5ec \uc77c\uad00\uc131\uacfc \uc720\uc9c0\ubcf4\uc218\uc131\uc744 \ub192\uc785\ub2c8\ub2e4."}),"\n",(0,s.jsxs)(r.blockquote,{children:["\n",(0,s.jsx)(r.p,{children:"\ucffc\ub9ac \ud0a4\ub97c \uc218\ub3d9\uc73c\ub85c \ub9ce\uc774 \uc120\uc5b8\ud558\uba74 \uc624\ub958\uac00 \ubc1c\uc0dd\ud558\uae30 \uc26c\uc6b8 \ubfd0\ub9cc \uc544\ub2c8\ub77c \ub098\uc911\uc5d0 \ud0a4\uc5d0 \ub2e4\ub978 \uc218\uc900\uc758 \uc138\ubd84\uc131\uc744 \ucd94\uac00\ud558\ub824\ub294 \uacbd\uc6b0\uc640 \uac19\uc774 \ubcc0\uacbd\ud558\uae30\uac00 \ub354 \uc5b4\ub824\uc6cc\uc9d1\ub2c8\ub2e4. \uadf8\ub807\uae30 \ub54c\ubb38\uc5d0 \uae30\ub2a5\ub2f9 \ud558\ub098\uc758 \ucffc\ub9ac \ud0a4 \ud329\ud1a0\ub9ac\ub97c \uc0ac\uc6a9\ud558\ub294 \uac83\uc774 \uc88b\uc2b5\ub2c8\ub2e4."}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.em,{children:"Dominik D"})}),"\n"]}),"\n",(0,s.jsx)(r.h3,{id:"\uc608\uc2dc-\ucf54\ub4dc",children:"\uc608\uc2dc \ucf54\ub4dc"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"const todoKeys = {\r\n  all: ['todos'] as const,\r\n  lists: () => [...todoKeys.all, 'list'] as const,\r\n  list: (filters: string) => [...todoKeys.lists(), { filters }] as const,\r\n  details: () => [...todoKeys.all, 'detail'] as const,\r\n  detail: (id: number) => [...todoKeys.details(), id] as const,\r\n};\r\n\r\nuseQuery({\r\n  queryKey: todoKeys.detail(todoId),\r\n  queryFn: () => fetchTodo(todoId),\r\n});\r\n\r\nqueryClient.removeQueries({\r\n  queryKey: todoKeys.all,\r\n});\r\n\r\nqueryClient.invalidateQueries({\r\n  queryKey: todoKeys.lists(),\r\n});\r\n\r\nqueryClient.prefetchQueries({\r\n  queryKey: todoKeys.detail(id),\r\n  queryFn: () => fetchTodo(id),\r\n});\n"})}),"\n",(0,s.jsx)(r.h2,{id:"2-querykey-factories\uc758-\ubb38\uc81c\uc810",children:"2. QueryKey factories\uc758 \ubb38\uc81c\uc810"}),"\n",(0,s.jsx)(r.p,{children:"\ucffc\ub9ac \ud0a4 \ud329\ud1a0\ub9ac \ud328\ud134\uc740 \ucffc\ub9ac \uad00\ub9ac\ub97c \ud6a8\uc728\uc801\uc73c\ub85c \ub9cc\ub4e4\uc5b4\uc8fc\uc9c0\ub9cc, \ud0c0\uc785\uc2a4\ud06c\ub9bd\ud2b8\uc758 \uad6c\uc870\uc801 \ud0c0\uc785 \uc2dc\uc2a4\ud15c\uc73c\ub85c \uc778\ud574 \ubcc4\ub3c4\uc758 \uac1d\uccb4\uc5d0\uc11c \ubc1c\uc0dd\ud55c \uc624\ud0c0\ub098 \uc798\ubabb\ub41c \ud544\ub4dc \uc0ac\uc6a9\uacfc \uac19\uc740 \ubb38\uc81c\ub97c \uc27d\uac8c \ucc3e\uc9c0 \ubabb\ud558\ub294 \ub2e8\uc810\uc774 \uc788\uc2b5\ub2c8\ub2e4."}),"\n",(0,s.jsx)(r.h3,{id:"\uc608\uc2dc-\ucf54\ub4dc-1",children:"\uc608\uc2dc \ucf54\ub4dc"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"useQuery({\r\n  queryKey: ['todos'],\r\n  queryFn: fetchTodos,\r\n  stallTime: 5000, // staleTime\uc758 \uc624\ud0c0 - \ud0c0\uc785 \uc5d0\ub7ec \ubc1c\uc0dd\r\n});\r\n\r\nconst todosQuery = {\r\n  queryKey: ['todos'],\r\n  queryFn: fetchTodos,\r\n  stallTime: 5000, // staleTime\uc758 \uc624\ud0c0 \r\n};\r\n\r\nuseQuery(todosQuery); // \ud0c0\uc785 \uc5d0\ub7ec\uac00 \ubc1c\uc0dd\ud558\uc9c0 \uc54a\uc74c\n"})}),"\n",(0,s.jsx)(r.h2,{id:"3-queryoptions\uc758-\ub4f1\uc7a5",children:"3. queryOptions\uc758 \ub4f1\uc7a5"}),"\n",(0,s.jsxs)(r.p,{children:["TanStack React Query v5 \uc5d0\uc11c\ub294 \uc774\ub7ec\ud55c \ubb38\uc81c\ub97c \ud574\uacb0\ud558\uace0\uc790 ",(0,s.jsx)(r.code,{children:"queryOptions"})," API\uac00 \ub3c4\uc785\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \uc774 API\ub294 \ucffc\ub9ac\ud0a4\uc640 \ucffc\ub9ac \ud568\uc218\ub97c \ud558\ub098\uc758 \uac1d\uccb4\ub85c \ubb36\uc5b4 \ud0c0\uc785\uc2a4\ud06c\ub9bd\ud2b8\uc758 \ud0c0\uc785 \ucd94\ub860\uc744 \ub354\uc6b1 \uba85\ud655\ud558\uac8c \ud560 \uc218 \uc788\uac8c \ud574\uc90d\ub2c8\ub2e4."]}),"\n",(0,s.jsx)(r.p,{children:"\ub0b4\ubd80\uc801\uc73c\ub85c\ub294 \ub7f0\ud0c0\uc784\uc5d0 \uc544\ubb34\ub7f0 \uc601\ud5a5\uc744 \uc8fc\uc9c0 \uc54a\ub294 \ub2e8\uc21c identity \ud568\uc218\uc774\uc9c0\ub9cc, \ud0c0\uc785\uc2a4\ud06c\ub9bd\ud2b8 \uce21\uba74\uc5d0\uc11c \ucffc\ub9ac\ud0a4\uc640 \ucffc\ub9ac \ud568\uc218\uc758 \ubc18\ud658 \ud0c0\uc785\uc744 \uc5f0\uacb0\ud574 \uac15\ub825\ud55c \ud0c0\uc785 \uc548\uc804\uc131\uc744 \uc81c\uacf5\ud569\ub2c8\ub2e4. \uc774\ub97c \ud1b5\ud574 \ucffc\ub9ac \ub370\uc774\ud130\ub97c \uac00\uc838\uc624\uac70\ub098 \uc124\uc815\ud560 \ub54c \uc62c\ubc14\ub978 \ub370\uc774\ud130 \ud0c0\uc785\uc774 \uc790\ub3d9\uc73c\ub85c \ucd94\ub860\ub418\uc5b4, \ubd88\ud544\uc694\ud55c \ud0c0\uc785 \uba85\uc2dc \uc5c6\uc774\ub3c4 \uc548\uc804\ud558\uac8c \ucf54\ub4dc\ub97c \uc791\uc131\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."}),"\n",(0,s.jsx)(r.admonition,{type:"info",children:(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"queryOptions"}),"\ub294 ",(0,s.jsx)(r.code,{children:"useQuery"}),", ",(0,s.jsx)(r.code,{children:"fetchQuery"}),", ",(0,s.jsx)(r.code,{children:"invalidateQueries"}),", ",(0,s.jsx)(r.code,{children:"getQueryData"}),", ",(0,s.jsx)(r.code,{children:"setQueryData"})," \ub4f1 \ub2e4\uc591\ud55c API\uc5d0\uc11c \ub3d9\uc77c\ud55c \uc635\uc158 \uac1d\uccb4\ub85c \uc7ac\uc0ac\uc6a9 \uac00\ub2a5\ud569\ub2c8\ub2e4."]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"getQueryData(queryKey)"})," \ud638\ucd9c \uc2dc, \uc790\ub3d9\uc73c\ub85c \uc815\ud655\ud55c \ud0c0\uc785 \ucd94\ub860\uc774 \uc774\ub8e8\uc5b4\uc9d1\ub2c8\ub2e4."]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"setQueryData"})," \uc5ed\uc2dc \uc774\uc804 \ub370\uc774\ud130\uc758 \uc815\ud655\ud55c \ud0c0\uc785\uc744 \ucd94\ub860\ud574\uc90d\ub2c8\ub2e4."]}),"\n"]})}),"\n",(0,s.jsx)(r.h3,{id:"\uc608\uc2dc-\ucf54\ub4dc-2",children:"\uc608\uc2dc \ucf54\ub4dc"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"const todoDetailQuery = (id: number) => queryOptions({\r\n  queryKey: ['todos', 'detail', id],\r\n  queryFn: () => fetchTodo(id),\r\n  staleTime: 30000,\r\n});\r\n\r\nuseQuery(todoDetailQuery(todoId));\n"})}),"\n",(0,s.jsx)(r.h2,{id:"4-querykey-factories\ub97c-queryoptions\ub85c-\uac15\ud654\ud558\uae30",children:"4. QueryKey factories\ub97c queryOptions\ub85c \uac15\ud654\ud558\uae30"}),"\n",(0,s.jsxs)(r.p,{children:["\uae30\uc874 \ucffc\ub9ac \ud0a4 \ud329\ud1a0\ub9ac \ud328\ud134\uc5d0 ",(0,s.jsx)(r.code,{children:"queryOptions"})," \ub97c \uacb0\ud569\ud558\uba74, \ucffc\ub9ac \ud0a4 \uad00\ub9ac\uc758 \uc77c\uad00\uc131\uacfc \uc7ac\uc0ac\uc6a9\uc131\uc740 \ubb3c\ub860 \ud0c0\uc785 \uc548\uc815\uc131\uae4c\uc9c0 \ud655\ubcf4\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \ud2b9\ud788 \ubcf5\uc7a1\ud55c \ub3c4\uba54\uc778 \uad6c\uc870\uc5d0\uc11c \ub354\uc6b1 \ud6a8\uacfc\uc801\uc73c\ub85c \uc791\ub3d9\ud569\ub2c8\ub2e4."]}),"\n",(0,s.jsx)(r.h3,{id:"\uc608\uc2dc-\ucf54\ub4dc-3",children:"\uc608\uc2dc \ucf54\ub4dc"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"const todoQueries = {\r\n  all: () => ['todos'],\r\n  lists: () => [...todoQueries.all(), 'list'],\r\n  list: (filters: string) =>\r\n    queryOptions({\r\n      queryKey: [...todoQueries.lists(), filters],\r\n      queryFn: () => fetchTodos(filters),\r\n    }),\r\n  details: () => [...todoQueries.all(), 'detail'],\r\n  detail: (id: number) =>\r\n    queryOptions({\r\n      queryKey: [...todoQueries.details(), id],\r\n      queryFn: () => fetchTodo(id),\r\n      staleTime: 5000,\r\n    }),\r\n};\r\n\r\n// \uc2e4\uc81c \uc0ac\uc6a9\r\nuseQuery(todoQueries.detail(1));\r\nqueryClient.prefetchQuery(todoQueries.detail(2));\n"})}),"\n",(0,s.jsx)(r.p,{children:"\uc774\ucc98\ub7fc \uc815\uc758\ud574\ub450\uba74 \uc790\ub3d9 \uc644\uc131\uacfc \ud0c0\uc785 \ucd94\ub860\uc758 \ub3c4\uc6c0\uc744 \ubc1b\uc544 \uc2e4\uc218\ub97c \uc904\uc77c \uc218 \uc788\uc73c\uba70, \uc720\uc9c0\ubcf4\uc218\uc131\uacfc \uac1c\ubc1c \uc0dd\uc0b0\uc131\uc744 \ubaa8\ub450 \ud5a5\uc0c1\uc2dc\ud0ac \uc218 \uc788\uc2b5\ub2c8\ub2e4"}),"\n",(0,s.jsx)(r.h2,{id:"5-\uacb0\ub860",children:"5. \uacb0\ub860"}),"\n",(0,s.jsxs)(r.p,{children:["Query factories\ub294 React Query\uc758 \ud0a4 \uad00\ub9ac\ub97c \ud6a8\uc728\uc801\uc774\uace0 \uccb4\uacc4\uc801\uc73c\ub85c \ub9cc\ub4e4\uc5b4\uc90d\ub2c8\ub2e4. \uc5ec\uae30\uc5d0 ",(0,s.jsx)(r.code,{children:"queryOptions"})," \ub97c \uacb0\ud569\ud558\uba74 \ubcf4\ub2e4 \uc815\uad50\ud55c \ud0c0\uc785 \uc548\uc804\uc131\uacfc \uba85\ud655\ud55c \uad6c\uc870\ub97c \uc81c\uacf5\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \ub530\ub77c\uc11c \uc55e\uc73c\ub85c \uc774\ub97c \uc801\uc6a9\ud558\uc5ec \ub354\uc6b1 \uc548\uc815\uc801\uc774\uace0 \uc6b0\uc544\ud55c \ucf54\ub4dc\ub97c \uc791\uc131\ud558\ub294 \uac83\uc774 \uac00\uc7a5 \uc88b\uc740 \ubc29\ubc95\uc778 \uac83 \uac19\uc2b5\ub2c8\ub2e4."]}),"\n",(0,s.jsx)("br",{}),"\n",(0,s.jsx)(r.admonition,{title:"\ucc38\uace0\uc790\ub8cc",type:"note",children:(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"https://youtu.be/bhE3wuB_TuA?si=spuFBTq-WUscp5bE",children:"https://youtu.be/bhE3wuB_TuA?si=spuFBTq-WUscp5bE"})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"https://tanstack.com/query/latest/docs/framework/react/guides/query-options",children:"https://tanstack.com/query/latest/docs/framework/react/guides/query-options"})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"https://tkdodo.eu/blog/the-query-options-api#queryoptions",children:"https://tkdodo.eu/blog/the-query-options-api#queryoptions"})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"https://tkdodo.eu/blog/effective-react-query-keys#use-query-key-factories",children:"https://tkdodo.eu/blog/effective-react-query-keys#use-query-key-factories"})}),"\n"]})})]})}function a(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8356:(e,r,t)=>{t.d(r,{R:()=>o,x:()=>l});var n=t(6672);const s={},i=n.createContext(s);function o(e){const r=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),n.createElement(i.Provider,{value:r},e.children)}}}]);