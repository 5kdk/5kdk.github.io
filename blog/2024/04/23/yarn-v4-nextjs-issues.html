<!doctype html>
<html lang="ko-kr" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Yarn v4, Next.js 환경 세팅과 마주했던 이슈들 | 5kdk 개발 블로그</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://5kdk.github.io/img/snoopy-joe-cool.webp"><meta data-rh="true" name="twitter:image" content="https://5kdk.github.io/img/snoopy-joe-cool.webp"><meta data-rh="true" property="og:url" content="https://5kdk.github.io/blog/2024/04/23/yarn-v4-nextjs-issues"><meta data-rh="true" property="og:locale" content="ko_kr"><meta data-rh="true" name="docusaurus_locale" content="ko-kr"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="ko-kr"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="google-site-verification" content="YuTDNs5sShtABibry84DadMRPWqRvlwdaEs4VEJNhi4"><meta data-rh="true" name="naver-site-verification" content="3855a4bfab2899d89b15098aceedacef12fa1fa8"><meta data-rh="true" property="og:title" content="Yarn v4, Next.js 환경 세팅과 마주했던 이슈들 | 5kdk 개발 블로그"><meta data-rh="true" name="description" content="yarn berry에 입문하며 마주한 이슈들과 배운점을 정리한다."><meta data-rh="true" property="og:description" content="yarn berry에 입문하며 마주한 이슈들과 배운점을 정리한다."><meta data-rh="true" name="keywords" content="yarn 4.0,yarn berry 4,storybook pnp,yarn berry git lfs,zero-install,Next.js 14 and yarn berry,yarn 스토리북"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-04-23T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/5kdk"><meta data-rh="true" property="article:tag" content="Yarn,Next.js,Storybook,Github"><link data-rh="true" rel="icon" href="/img/snoopy-spoon.png"><link data-rh="true" rel="canonical" href="https://5kdk.github.io/blog/2024/04/23/yarn-v4-nextjs-issues"><link data-rh="true" rel="alternate" href="https://5kdk.github.io/blog/2024/04/23/yarn-v4-nextjs-issues" hreflang="ko-kr"><link data-rh="true" rel="alternate" href="https://5kdk.github.io/blog/2024/04/23/yarn-v4-nextjs-issues" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://6BL9UAGD47-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://5kdk.github.io/blog/2024/04/23/yarn-v4-nextjs-issues","mainEntityOfPage":"https://5kdk.github.io/blog/2024/04/23/yarn-v4-nextjs-issues","url":"https://5kdk.github.io/blog/2024/04/23/yarn-v4-nextjs-issues","headline":"Yarn v4, Next.js 환경 세팅과 마주했던 이슈들","name":"Yarn v4, Next.js 환경 세팅과 마주했던 이슈들","description":"yarn berry에 입문하며 마주한 이슈들과 배운점을 정리한다.","datePublished":"2024-04-23T00:00:00.000Z","author":{"@type":"Person","name":"Dongkyu Kim","description":"Front-end Developer","url":"https://github.com/5kdk","image":"https://github.com/5kdk.png"},"keywords":["yarn 4.0","yarn berry 4","storybook pnp","yarn berry git lfs","zero-install","Next.js 14 and yarn berry","yarn 스토리북"],"isPartOf":{"@type":"Blog","@id":"https://5kdk.github.io/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="5kdk 개발 블로그 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="5kdk 개발 블로그 Atom Feed">




<link rel="search" type="application/opensearchdescription+xml" title="5kdk 개발 블로그" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.9527497d.css">
<script src="/assets/js/runtime~main.ae39ed11.js" defer="defer"></script>
<script src="/assets/js/main.c910b49d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const a=new URLSearchParams(window.location.search).entries();for(var[t,e]of a)if(t.startsWith("docusaurus-data-")){var n=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(n,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/snoopy-spoon.png"><link rel="preload" as="image" href="https://github.com/5kdk.png"><div role="region" aria-label="본문으로 건너뛰기"><a class="skipToContent_g8VU" href="#__docusaurus_skipToContent_fallback">본문으로 건너뛰기</a></div><div class="announcementBar_sgar" role="banner"><div class="announcementBarPlaceholder_VwGZ"></div><div class="content_m_Tw announcementBarContent_N9L9">👋 안녕하세요! 블로그 방문을 환영합니다. 도움이 되셨다면 <a target="_blank" rel="noopener noreferrer" href="https://github.com/5kdk/5kdk.github.io">GitHub repo</a>에 🌟를 남겨주세요.</div><button type="button" aria-label="닫기" class="clean-btn close closeButton_yiyZ announcementBarClose_uiO3"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="메인" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="사이드바 펼치거나 접기" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/snoopy-spoon.png" alt="5kdk Logo" class="themedComponent_C6Ki themedComponent--light_HEG7"><img src="/img/snoopy-spoon.png" alt="5kdk Logo" class="themedComponent_C6Ki themedComponent--dark_amga"></div><b class="navbar__title text--truncate">5kdk</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/5kdk" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_EzHz"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_DiVW colorModeToggle_oLkM"><button class="clean-btn toggleButton_Jaig toggleButtonDisabled_taPI" type="button" disabled="" title="어두운 모드와 밝은 모드 전환하기 (현재 밝은 모드)" aria-label="어두운 모드와 밝은 모드 전환하기 (현재 밝은 모드)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_GFUl"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_O8_F"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_hUdz"><button type="button" class="DocSearch DocSearch-Button" aria-label="검색 (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">검색</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_dgTS"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_OCAr thin-scrollbar" aria-label="최근 블로그 문서 둘러보기"><div class="sidebarItemTitle_dYP2 margin-bottom--md">모든 포스트</div><div role="group"><h3 class="yearGroupHeading_ihhD">2025</h3><ul class="sidebarItemList_c7Ya clean-list"><li class="sidebarItem_NIPv"><a class="sidebarItemLink_XcrN" href="/blog/2025/05/19/reduce-firebase-cost">Firebase 사용료 폭탄, 90% 가까이 비용 절감한 경험기</a></li><li class="sidebarItem_NIPv"><a class="sidebarItemLink_XcrN" href="/blog/2025/05/02/image-caching">CDN 이미지 파일 교체 후 Next.js &lt;Image&gt; 컴포넌트 캐싱 문제 해결하기</a></li><li class="sidebarItem_NIPv"><a class="sidebarItemLink_XcrN" href="/blog/2025/04/28/flawless-ux-frontend-strategy">허점 없는 UX를 만드는 프론트엔드 전략</a></li><li class="sidebarItem_NIPv"><a class="sidebarItemLink_XcrN" href="/blog/2025/04/04/query-factory">Querykey factory에서 Query factory로</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_ihhD">2024</h3><ul class="sidebarItemList_c7Ya clean-list"><li class="sidebarItem_NIPv"><a aria-current="page" class="sidebarItemLink_XcrN sidebarItemLinkActive_jRB9" href="/blog/2024/04/23/yarn-v4-nextjs-issues">Yarn v4, Next.js 환경 세팅과 마주했던 이슈들</a></li><li class="sidebarItem_NIPv"><a class="sidebarItemLink_XcrN" href="/blog/2024/04/04/index-signatures-and-duck-typing">타입스크립트의 인덱스 시그니처와 Object.keys 그리고 덕 타이핑</a></li><li class="sidebarItem_NIPv"><a class="sidebarItemLink_XcrN" href="/blog/2024/03/02/utility-type">알아두면 유용한 11가지 유틸리티 타입</a></li><li class="sidebarItem_NIPv"><a class="sidebarItemLink_XcrN" href="/blog/2024/02/11/12-modern-css.md">12가지 최신 CSS 한 줄 업그레이드</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_ihhD">2023</h3><ul class="sidebarItemList_c7Ya clean-list"><li class="sidebarItem_NIPv"><a class="sidebarItemLink_XcrN" href="/blog/2023/11/26/eslint-deep-dive">좋은 코드를 위한 ESLint 정적 분석 딥 다이브</a></li><li class="sidebarItem_NIPv"><a class="sidebarItemLink_XcrN" href="/blog/2023/11/24/modern-react-deep-dive-review">모던 리액트 Deep dive 솔직 후기</a></li><li class="sidebarItem_NIPv"><a class="sidebarItemLink_XcrN" href="/blog/2023/11/09/improving-cwv-nextjs">Next.js를 중심으로 한 코어 웹 바이탈 최적화</a></li><li class="sidebarItem_NIPv"><a class="sidebarItemLink_XcrN" href="/blog/2023/11/01/measure-core-web-vitals">코어 웹 바이탈 측정을 위한 도구 모음</a></li><li class="sidebarItem_NIPv"><a class="sidebarItemLink_XcrN" href="/blog/2023/10/24/core-web-vitals">웹 성능 지표, 코어 웹 바이탈(CWV)</a></li><li class="sidebarItem_NIPv"><a class="sidebarItemLink_XcrN" href="/blog/2023/10/18/suspense-for-data-fetching">Suspense, Error Boundary와 선언적 데이터 패칭</a></li><li class="sidebarItem_NIPv"><a class="sidebarItemLink_XcrN" href="/blog/2023/07/23/caching-technique-without-libraries">라이브러리 없이 로컬 캐싱 구현하기</a></li><li class="sidebarItem_NIPv"><a class="sidebarItemLink_XcrN" href="/blog/2023/07/04/necessary-with-usememo-and-usecallback">useMemo, useCallback으로 최적화가 꼭 필요할까?</a></li><li class="sidebarItem_NIPv"><a class="sidebarItemLink_XcrN" href="/blog/2023/06/17/usenavigate-options">useNavigate의 옵션을 활용한 뒤로가기 사용성 개선</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_ihhD">2022</h3><ul class="sidebarItemList_c7Ya clean-list"><li class="sidebarItem_NIPv"><a class="sidebarItemLink_XcrN" href="/blog/2022/12/15/advanced-usage-of-useeffect-with-usecallback">useCallback으로 useEffect 심화 활용 해보기</a></li><li class="sidebarItem_NIPv"><a class="sidebarItemLink_XcrN" href="/blog/2022/12/10/react-key-props">key가 필요한 이유와 주의할 점</a></li><li class="sidebarItem_NIPv"><a class="sidebarItemLink_XcrN" href="/blog/2022/11/11/11-array-iteration-methods">배열 반복을 효과적으로 만드는 11가지 메서드</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_D2rc">Yarn v4, Next.js 환경 세팅과 마주했던 이슈들</h1><div class="container_m44_ margin-vert--md"><time datetime="2024-04-23T00:00:00.000Z">2024년 4월 23일</time> · <!-- -->약 13분</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_T5zZ"><div class="avatar margin-bottom--sm"><a href="https://github.com/5kdk" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_xud3" src="https://github.com/5kdk.png" alt="Dongkyu Kim"></a><div class="avatar__intro authorDetails_zCJ8"><div class="avatar__name"><a href="https://github.com/5kdk" target="_blank" rel="noopener noreferrer"><span class="authorName_V07E">Dongkyu Kim</span></a></div><small class="authorTitle_zUP3" title="Front-end Developer">Front-end Developer</small><div class="authorSocials_QUm9"></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>개인 Next.js 보일러 플레이트를 세팅하면서 Yarn 4 의 PnP(Plug And Play)와 Zero-install로 환경을 구성을 시도해보았다. 이번에 환경을 세팅하며 마주했던 상황들과 이슈들을 정리해본다. 편의상 Yarn PnP를 Yarn berry라 부르겠다.</p>
<h2 class="anchor anchorWithStickyNavbar_UbLc" id="yarnrcyml-이-어디에">.yarnrc.yml 이 어디에?<a href="#yarnrcyml-이-어디에" class="hash-link" aria-label=".yarnrc.yml 이 어디에?에 대한 직접 링크" title=".yarnrc.yml 이 어디에?에 대한 직접 링크">​</a></h2>
<div class="language-yml codeBlockContainer_NX5H theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Rdc5">.yarnrc.yml</div><div class="codeBlockContent_gk39"><pre tabindex="0" class="prism-code language-yml codeBlock_1nhV thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_lJPk"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">nodeLinker</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> pnp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">yarnPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> .yarn/releases/yarn</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">3.2.1.cjs</span><br></span></code></pre><div class="buttonGroup_vInq"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_o7Aj" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_K_gu"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_GlTF"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Yarn berry v2, v3 세팅 시 위와 같은 설정 파일이 생성됐었다. Yarn berry v4에서는 더 이상 기본으로 생성되지 않는다.</p>
<h3 class="anchor anchorWithStickyNavbar_UbLc" id="yarnpath를-설정해야-할까">yarnPath를 설정해야 할까?<a href="#yarnpath를-설정해야-할까" class="hash-link" aria-label="yarnPath를 설정해야 할까?에 대한 직접 링크" title="yarnPath를 설정해야 할까?에 대한 직접 링크">​</a></h3>
<p>글로벌 바이너리 대신 사용할 Yarn 바이너리의 경로인데, 이 바이너리는 rc 파일이 포함된 디렉터리 내에서 실행되는 모든 명령에 대해 다른 바이너리(전역 바이너리 포함) 대신 실행된다. (Node 환경에서 <code>.nvmrc</code>를 설정하듯 프로젝트에 참여한 모든 개발자가 같은 버젼을 사용하기 위한 방법)</p>
<p>Yarn에서는 v2부터 프로젝트별로 바이너리를 가리키는 <code>yarnPath</code> 설정을 사용하도록 권장했지만, 많은 사람들이 아무리 작은 바이너리를 레포지토리에 추가하는 것을 좋아 하지 않았기 때문에 Corepack 프로젝트를 진행했다고 한다.</p>
<p>Corepack은 Node 18과 20 모두와 함께 제공되므로 더 이상 <code>yarnPath</code>에 의존할 필요가 없으며, 이에 따라 패키지 관리자 필드를 업데이트하도록 <code>yarn init -2</code> 및 <code>yarn set version</code> 명령도 업데이트되었다.</p>
<p>즉 Yarn v4 이전에는 프로젝트 내에서 Yarn을 설치하는 데 <code>yarnPath</code> 설정이 선호되었지만, 이제 대부분의 경우 Corepack을 사용하는 것이 좋다고 한다.</p>
<div class="theme-admonition theme-admonition-info admonition_mGRu alert alert--info"><div class="admonitionHeading_m7RP"><span class="admonitionIcon_Qlcp"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>정보</div><div class="admonitionContent_Cx0A"><p>Corepack은 작업 중인 프로젝트에 따라 실행할 올바른 패키지 관리자 버전을 자동으로 선택하는 Node.js 16+와 함께 제공되는 도구입니다.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_UbLc" id="yarn-berry의-zero-install-설정">Yarn berry의 zero-install 설정<a href="#yarn-berry의-zero-install-설정" class="hash-link" aria-label="Yarn berry의 zero-install 설정에 대한 직접 링크" title="Yarn berry의 zero-install 설정에 대한 직접 링크">​</a></h3>
<p>Yarn berry에서 zero-install이 더 이상 default 옵션으로 제공하지 않는다. 대신에, global yarn cache를 참조한다.
따라서 아래와 같이 글로벌 캐시를 비활성화해야 <code>.yarn/cache</code>폴더가 생성되고 zero-install을 구성할 수 있다.</p>
<div class="language-yml codeBlockContainer_NX5H theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Rdc5">.yarnrc.yml</div><div class="codeBlockContent_gk39"><pre tabindex="0" class="prism-code language-yml codeBlock_1nhV thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_lJPk"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 글로벌 캐시 비활성화 (기본옵션 true)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">enableGlobalCache</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">false</span><br></span></code></pre><div class="buttonGroup_vInq"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_o7Aj" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_K_gu"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_GlTF"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p><strong>Read More:</strong><br>
<a href="https://yarnpkg.com/blog/release/4.0" target="_blank" rel="noopener noreferrer"><em>yarn release 4.0</em></a><br>
<a href="https://yarnpkg.com/configuration/yarnrc#yarnPath" target="_blank" rel="noopener noreferrer"><em>yarnPath</em></a></p>
</blockquote>
<br>
<h2 class="anchor anchorWithStickyNavbar_UbLc" id="idevscode-타입스크립트-문제">IDE(vscode) 타입스크립트 문제<a href="#idevscode-타입스크립트-문제" class="hash-link" aria-label="IDE(vscode) 타입스크립트 문제에 대한 직접 링크" title="IDE(vscode) 타입스크립트 문제에 대한 직접 링크">​</a></h2>
<p>Vscode의 Yarn berry 환경에서는 <code>ts</code>, <code>tsx</code>에 빨간줄이 난무하게 되는데 Vscode에서 타입스크립트와 PnP 설치모드를 사용하려면 추가 작업이 필요하다.</p>
<ul>
<li>Yarn 팀에서 유지 관리하는 <a href="https://marketplace.visualstudio.com/items?itemName=arcanis.vscode-zipfs" target="_blank" rel="noopener noreferrer">ZipFS</a> 확장을 설치</li>
<li><code>yarn dlx @yarnpkg/sdks</code></li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_mGRu alert alert--info"><div class="admonitionHeading_m7RP"><span class="admonitionIcon_Qlcp"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Yarn PnP에 SDK가 필요한 이유는?</div><div class="admonitionContent_Cx0A"><p>Yarn PnP는 Node.js 런타임 내에 삽입해야 하는 Node.js 로더를 생성하는 방식으로 작동합니다. 많은 IDE 확장 프로그램은 로더를 고려하지 않고 래핑하는 패키지(Prettier, TypeScript, ...)를 실행합니다.</p><p>SDK는 인디렉션 패키지를 생성하여 이를 해결합니다. 필요한 경우 이러한 인디렉션은 필요한 호출을 실제 패키지로 전달하기 전에 자동으로 로더를 설정합니다.</p></div></div>
<blockquote>
<p><strong>Read More:</strong><br>
<a href="https://yarnpkg.com/getting-started/editor-sdks" target="_blank" rel="noopener noreferrer"><em>Editor-sdks</em></a></p>
</blockquote>
<br>
<h2 class="anchor anchorWithStickyNavbar_UbLc" id="yarn-berry에서-storybook-세팅하며-만난-이슈">Yarn berry에서 Storybook 세팅하며 만난 이슈<a href="#yarn-berry에서-storybook-세팅하며-만난-이슈" class="hash-link" aria-label="Yarn berry에서 Storybook 세팅하며 만난 이슈에 대한 직접 링크" title="Yarn berry에서 Storybook 세팅하며 만난 이슈에 대한 직접 링크">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_UbLc" id="패키지-종속성-문제">패키지 종속성 문제<a href="#패키지-종속성-문제" class="hash-link" aria-label="패키지 종속성 문제에 대한 직접 링크" title="패키지 종속성 문제에 대한 직접 링크">​</a></h3>
<div class="language-bash codeBlockContainer_NX5H theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_gk39"><pre tabindex="0" class="prism-code language-bash codeBlock_1nhV thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_lJPk"><span class="token-line" style="color:#393A34"><span class="token plain">Error: @chromatic-com/storybook tried to access @storybook/core-events, but it isn&#x27;t declared </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> its dependencies</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> this makes the require call ambiguous and unsound.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Required package: @storybook/core-events </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">via </span><span class="token string" style="color:#e3116c">&quot;@storybook</span><span class="token string entity" style="color:#36acaa">\c</span><span class="token string" style="color:#e3116c">ore-events\server-errors&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup_vInq"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_o7Aj" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_K_gu"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_GlTF"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>호이스팅 전략을 고려하지 않는 패키지들은 종속성 문제를 일으킬 수 있는데, Storybook 관련 패키지들이 그러하였다.
비단 Storybook만의 문제는 아니며, Yarn berry가 까다로운 이유 중 하나인 것 같다.</p>
<p>필요한 패키지를 <code>yarn add</code> 해도 해결되지만, 패키지 중복을 피하고자 아래와 같이 확장구문을 작성해주면 된다.</p>
<div class="language-yml codeBlockContainer_NX5H theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Rdc5">.yarnrc.yml</div><div class="codeBlockContent_gk39"><pre tabindex="0" class="prism-code language-yml codeBlock_1nhV thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_lJPk"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">packageExtensions</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">&#x27;@storybook/nextjs@*&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">dependencies</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">&#x27;webpack&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;*&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">&#x27;@chromatic-com/storybook@*&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">dependencies</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">&#x27;@storybook/client-logger&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;*&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">&#x27;@storybook/core-events&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;*&#x27;</span><br></span></code></pre><div class="buttonGroup_vInq"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_o7Aj" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_K_gu"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_GlTF"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-info admonition_mGRu alert alert--info"><div class="admonitionHeading_m7RP"><span class="admonitionIcon_Qlcp"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>정보</div><div class="admonitionContent_Cx0A"><p>종속성의 패키지 정의를 확장하여 타사 문제를 해결하는 데 유용합니다.</p><p>일부 패키지는 종속성과 관련하여 잘못 지정되었을 수 있습니다(예: 하나의 종속성이 누락되어 Yarn이 해당 종속성에 대한 액세스를 거부하는 경우). packageExtensions 필드는 추가 정보로 기존 패키지 정의를 확장하는 방법을 제공합니다. 이 필드를 사용하는 경우 PR을 업스트림으로 전송하고 플러그인 호환 데이터베이스에 확장 기능을 기여하는 것이 좋습니다.</p><p>참고: 이 필드는 종속성을 추가하기 위해 만들어진 필드이므로 기존 종속성을 다시 작성해야 하는 경우 대신 해상도 필드를 사용하는 것이 좋습니다.</p><details class="details_lDVN alert alert--info details_VZP9" data-collapsed="true"><summary><b>원문</b></summary><div><div class="collapsibleContent_PpmG"><div><p>Extend the package definitions of your dependencies; useful to fix third-party issues.</p><p>Some packages may have been specified incorrectly with regard to their dependencies - for example with one dependency being missing, causing Yarn to refuse it the access. The packageExtensions fields offer a way to extend the existing package definitions with additional information. If you use it, consider sending a PR upstream and contributing your extension to the plugin-compat database.</p><p>Note: This field is made to add dependencies; if you need to rewrite existing ones, prefer the resolutions field instead.</p><blockquote>
<p><a href="https://yarnpkg.com/configuration/yarnrc#packageExtensions" target="_blank" rel="noopener noreferrer"><em>Yarn Docs</em></a></p>
</blockquote></div></div></div></details></div></div>
<h3 class="anchor anchorWithStickyNavbar_UbLc" id="storybook-빌드시-node_modules가-생긴다">storybook 빌드시 node_modules가 생긴다?<a href="#storybook-빌드시-node_modules가-생긴다" class="hash-link" aria-label="storybook 빌드시 node_modules가 생긴다?에 대한 직접 링크" title="storybook 빌드시 node_modules가 생긴다?에 대한 직접 링크">​</a></h3>
<div class="theme-admonition theme-admonition-info admonition_mGRu alert alert--info"><div class="admonitionHeading_m7RP"><span class="admonitionIcon_Qlcp"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>정보</div><div class="admonitionContent_Cx0A"><p><strong>스토리북을 통한 Yarn 플러그앤플레이(PnP) 지원</strong></p><p>플러그앤플레이(PnP)가 활성화된 새 버전의 Yarn에서 실행 중인 프로젝트에서 스토리북을 활성화한 경우 일부 추가 파일 및 폴더가 포함된 node_modules가 생성되는 것을 볼 수 있습니다. 이는 스토리북이 캐시 파일 및 기타 데이터를 저장하기 위해 일부 디렉터리(예: .cache)에 의존하여 성능을 개선하고 빌드 속도를 높이기 때문에 알려진 제약 조건입니다. 이러한 파일 및 폴더는 .gitignore 파일을 조정하여 사용 중인 버전 관리에서 제외하여 안전하게 무시할 수 있습니다.</p><details class="details_lDVN alert alert--info details_VZP9" data-collapsed="true"><summary><b>원문</b></summary><div><div class="collapsibleContent_PpmG"><div><p><strong>Yarn Plug&#x27;n&#x27;Play (PnP) support with Storybook</strong></p><p>If you&#x27;ve enabled Storybook in a project running on a new version of Yarn with Plug&#x27;n&#x27;Play (PnP) enabled, you may notice that it will generate node_modules with some additional files and folders. This is a known constraint as Storybook relies on some directories (e.g., .cache) to store cache files and other data to improve performance and faster builds. You can safely ignore these files and folders, adjusting your .gitignore file to exclude them from the version control you&#x27;re using.</p><blockquote>
<p><a href="https://storybook.js.org/docs/get-started/install#yarn-plugnplay-pnp-support-with-storybook" target="_blank" rel="noopener noreferrer"><em>Storybook Docs</em></a></p>
</blockquote></div></div></div></details></div></div>
<br>
<h2 class="anchor anchorWithStickyNavbar_UbLc" id="github-lfs-대역폭-이슈">Github LFS 대역폭 이슈<a href="#github-lfs-대역폭-이슈" class="hash-link" aria-label="Github LFS 대역폭 이슈에 대한 직접 링크" title="Github LFS 대역폭 이슈에 대한 직접 링크">​</a></h2>
<p>zero-install 으로 프로젝트를 구성한 후 가장 큰 문제는 GitHub의 대역폭 제한이었다. GitHub는 서비스 안정성을 위해 큰 용량의 파일을 제한하는 정책을 가지고 있는데, 이 큰 용량의 파일 기준이 50MB이다. PnP가 패키지를 압축한다 해도 50MB를 넘는 패키지가 많기 때문에 이는 상당한 제약이다. 일반적으로 이를 회피하기 위해 yarn/cache 폴더를 Git LFS를 사용하여 추적하고, 파일의 원본은 Git LFS 스토리지에 저장하여 포인터만 리포지토리에 유지한다.</p>
<p>위 과정을 마친 후 몇 가지 테스트를 진행하기위해 데스크탑과 랩탑에서 <code>git clone</code>을 시도하니 금새 대역폭 제한에 걸렸다.</p>
<p><img decoding="async" loading="lazy" alt="github 대역폭 제한" src="data:image/webp;base64,UklGRtYEAABXRUJQVlA4IMoEAAAwLwCdASqDBEYAPoFAnEmlJCMhJZ0okKAQCWdu4XdhGl43WlvQMu7f/0Z89NutXqZ9GdfUvi3SpxCShxxfrZ1NVSc1fyRFmNiBwKhEWVszsp4FQiLK2Z2U8CoRFlbM7KeBUIiytmdlPAqBEgF9FdFSOMZ+SgkQaNnKog+T5+tNBbELdn4MOBa228RA4FQiLK2Z1LLqejF0L7jsRy8beq4+kJWV+OyEMLJaQQzAN9Il6AaIsrZnZTwKhEWVszsp4FQiKi9MVZh4CUk5grL2+ahEFK5kVpoRW0GgCkoFqWYWKSbKM+07XFoXrguM5Rn2na4tC9cFxnKM+zLtzntxGQdLdh5E0z2n8J3GJeQApMdU0+606ngVCIsrZnZTwKhEWVszsp4FKnhgTmI4PJAtPQYSchQfHjZUtBtk5Cg+PGypaDbJyE4rOCjz0E/s6KUyJTwKhEWVszsp4FQiLK2Z2U8CoRFlbM7KeBUIiytmdlPAqERZWzOyngVCIsrZnZTwKhEAAAD+/9CXcL4vfR/00KAAEhAWqCPzL7Pccefz4j1BOjQ4zUCLK8p3f7f21y8GGJnBk9Pj2XKa/is4pz+ae2sub++LxX9G4oFahSF+6rpkxucVRldrZRUFPHPB3l6wNTecTjMVZE+jMYMlNr6U21GK7Dg1FU0RcbLLMS+xQlPobwut83MOgibfb2fGK0fjvT7taG67a+w5sb5fGMewWjbtbDzuk7pWwMzdb9H3OVSholKZIKBjDgLKSlO1wjsqZEd84z5TUBUsPoYuka2cN5p4EwJRpv2BpSD9NtiZ3p9khHgGPDIs4n2VS9EHMFoHTdIJGeTu31b05x2IoTWUtXIJ2RLZMAR3jrbb5RxYJStZd9iVrHJEelj/cUwcw9IwM3eRLbbM4nZYDMMSNYqncMTQWUIZNCl7X0uhI7XV4MKbaVvIGzL3KCYNBeFJjfEUN3px1qwYuobVyfWkiQxEQxH64tsMp5O45RGMQdDvekF4IfP4dpzzI2KsuPL5hmcF4Tk0lhDaREQb2oDVWYd3o85ZruwmWvGT+Cn1XdZtsPN2tpurUjA1z9igLA1vLb4HNPbmnHtSq3b3oUhFqg45lOHQ2V7GGYINnA3UCJdcmqCUNJYjxpz5CRFB+ljX9wTDaX68VvDvZNpL3PjIroG9wWgIUz9EFT4ZWG8E/l6Vnf9vDotNom9YVdzptKxXqDJdOTSLUrn7/E5AqddhwAZB2nvwZlM4SwM8ly6lUbU+jy17qTMfOMUZXJezsHgf8dzMla5E2U7EdyPx1OljBb5kcEDkHMB4xCZP/WWuy4fztruTqp5jupKhzFeQ4934+1RJLiGBQ7VEDwPspLiVG6FKAInj0JYCw3qs0MHHHshoNyHqIts/Fy6JQg0QgLEUn7ubXWnbqct94crStSq4a9TllH3sNjN+/LYB+GKoHo/qN09Vu0KA3Zs21cgjeRkCFh2xywnx9t1p2U687BRx8SbOXEDaAg0czjTwDYTU/ly0drTH/iMGQaAI7k73FRTixZTlj0gCjENXK3YIyxSm5bW4WXdyqmy8C5RaHGwAF/8NbIA50OkMelHrA+59h+yJEVdbRteIKTBgDcuZYph/x4P/M//FDBsq1kAAAAAAAA==" width="1155" height="70" class="img_lQJ8"></p>
<p>GitHub는 1GB 스토리지의 용량과 매달(25일) 1GB 대역폭을 무료로 제공하는데, 프로젝트의 패키지 LFS는 큰 용량를 차지하고 있어 무료로 제공되는 1GB 대역폭을 모두 금방 써버리게 된다. (bitbucket도 free plan은 매달 1GB를 제공한다)</p>
<div class="theme-admonition theme-admonition-info admonition_mGRu alert alert--info"><div class="admonitionHeading_m7RP"><span class="admonitionIcon_Qlcp"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>정보</div><div class="admonitionContent_Cx0A"><ul>
<li>Git LFS에 500MB 파일을 푸시하는 경우 할당된 스토리지의 500MB를 사용하고 대역폭은 사용하지 않습니다. 1바이트 변경을 수행하고 파일을 다시 푸시하는 경우 또 다른 500MB의 스토리지를 사용하고 대역폭은 사용하지 않으므로 이 두 푸시에 대한 총 사용량은 스토리지 1GB와 대역폭 0이 됩니다.</li>
<li>LFS로 추적된 500MB 파일을 다운로드하는 경우 리포지토리 소유자의 할당된 대역폭 500MB를 사용합니다. 협력자가 파일 변경을 푸시하고 새 버전을 로컬 리포지토리로 끌어오면 500MB의 대역폭을 추가로 사용하여 이 두 다운로드의 총 사용량은 1GB의 대역폭이 됩니다.</li>
<li>GitHub Actions이(가) LFS로 추적되는 500MB 파일을 다운로드하는 경우 리포지토리 소유자의 할당된 대역폭 500MB를 사용합니다.</li>
</ul><blockquote>
<p><a href="https://docs.github.com/ko/repositories/working-with-files/managing-large-files/about-storage-and-bandwidth-usage#tracking-storage-and-bandwidth-use" target="_blank" rel="noopener noreferrer"><em>GitHub Docs</em></a></p>
</blockquote></div></div>
<p>zero-install 아주 매력적인 전략이지만 우선 의존성 변경이 일어나면 내 레포지토리에 lfs로 tracking한 패키지들을 push를 하지 못하는 상황이고, 다른 디바이스에서 프로젝트를 온전히 사용할 수 없기에 PnP 모드를 사용하되 zero-install을 포기하기로 했다.</p>
<br>
<h2 class="anchor anchorWithStickyNavbar_UbLc" id="간단-yarn-pnp-nextjs-세팅-방법">간단 Yarn PnP, Next.js 세팅 방법<a href="#간단-yarn-pnp-nextjs-세팅-방법" class="hash-link" aria-label="간단 Yarn PnP, Next.js 세팅 방법에 대한 직접 링크" title="간단 Yarn PnP, Next.js 세팅 방법에 대한 직접 링크">​</a></h2>
<ul>
<li><code>npx create-next-app@latest</code></li>
<li><code>node_modules</code>, <code>package-lock.json</code> 삭제</li>
<li><code>corepack enable</code> 코어팩 활성화</li>
<li><code>yarn set version stable</code> Yarn v4 세팅</li>
<li><code>yarn install</code></li>
<li><code>.gitignore</code> 추가<!-- -->
<div class="language-. codeBlockContainer_NX5H theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Rdc5">.gitignore</div><div class="codeBlockContent_gk39"><pre tabindex="0" class="prism-code language-. codeBlock_1nhV thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_lJPk"><span class="token-line" style="color:#393A34"><span class="token plain">.pnp.*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.yarn/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!.yarn/patches</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!.yarn/plugins</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!.yarn/releases</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!.yarn/sdks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!.yarn/versions</span><br></span></code></pre><div class="buttonGroup_vInq"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_o7Aj" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_K_gu"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_GlTF"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>Done!</li>
</ul>
<p>zero-install을 사용하고 싶다면 global cache enable 설정 및 gitignore 변경, GitLFS 설치와 .yarn/cache 폴더를 tracking 및 git lfs push 과정 추가</p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>태그:</b><ul class="tags_xR49 padding--none margin-left--sm"><li class="tag_kERW"><a class="tag_wdqv tagRegular_YqDa" href="/blog/tags/yarn">Yarn</a></li><li class="tag_kERW"><a class="tag_wdqv tagRegular_YqDa" href="/blog/tags/next-js">Next.js</a></li><li class="tag_kERW"><a class="tag_wdqv tagRegular_YqDa" href="/blog/tags/storybook">Storybook</a></li><li class="tag_kERW"><a class="tag_wdqv tagRegular_YqDa" href="/blog/tags/github">Github</a></li></ul></div></div><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><a href="https://github.com/5kdk/5kdk.github.io/tree/main/blog/2024-04-23-yarn-v4-nextjs-issues/index.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_zmBT" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>페이지 편집</a></div><div class="col lastUpdated_fwvf"></div></div></footer></article><div></div><nav class="pagination-nav docusaurus-mt-lg" aria-label="블로그 게시물 탐색"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/2025/04/04/query-factory"><div class="pagination-nav__sublabel">이전 게시물</div><div class="pagination-nav__label">Querykey factory에서 Query factory로</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/2024/04/04/index-signatures-and-duck-typing"><div class="pagination-nav__sublabel">다음 게시물</div><div class="pagination-nav__label">타입스크립트의 인덱스 시그니처와 Object.keys 그리고 덕 타이핑</div></a></nav></main><div class="col col--2"><div class="tableOfContents_QFPq thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#yarnrcyml-이-어디에" class="table-of-contents__link toc-highlight">.yarnrc.yml 이 어디에?</a><ul><li><a href="#yarnpath를-설정해야-할까" class="table-of-contents__link toc-highlight">yarnPath를 설정해야 할까?</a></li><li><a href="#yarn-berry의-zero-install-설정" class="table-of-contents__link toc-highlight">Yarn berry의 zero-install 설정</a></li></ul></li><li><a href="#idevscode-타입스크립트-문제" class="table-of-contents__link toc-highlight">IDE(vscode) 타입스크립트 문제</a></li><li><a href="#yarn-berry에서-storybook-세팅하며-만난-이슈" class="table-of-contents__link toc-highlight">Yarn berry에서 Storybook 세팅하며 만난 이슈</a><ul><li><a href="#패키지-종속성-문제" class="table-of-contents__link toc-highlight">패키지 종속성 문제</a></li><li><a href="#storybook-빌드시-node_modules가-생긴다" class="table-of-contents__link toc-highlight">storybook 빌드시 node_modules가 생긴다?</a></li></ul></li><li><a href="#github-lfs-대역폭-이슈" class="table-of-contents__link toc-highlight">Github LFS 대역폭 이슈</a></li><li><a href="#간단-yarn-pnp-nextjs-세팅-방법" class="table-of-contents__link toc-highlight">간단 Yarn PnP, Next.js 세팅 방법</a></li></ul></div></div></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">5kdk</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/5kdk" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_EzHz"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 5kdk. Built with Docusaurus.🦖</div></div></div></footer></div>
</body>
</html>